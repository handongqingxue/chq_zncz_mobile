{"ast":null,"code":"import \"antd-mobile/es/modal/style\";\nimport _Modal from \"antd-mobile/es/modal\";\nimport \"antd-mobile/es/button/style\";\nimport _Button from \"antd-mobile/es/button\";\nimport \"antd-mobile/es/list/style\";\nimport _List from \"antd-mobile/es/list\";\nimport \"antd-mobile/es/tag/style\";\nimport _Tag from \"antd-mobile/es/tag\";\nimport \"antd-mobile/es/input-item/style\";\nimport _InputItem from \"antd-mobile/es/input-item\";\nimport _classCallCheck from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\hclient_mobile_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\hclient_mobile_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\hclient_mobile_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\hclient_mobile_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\hclient_mobile_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport \"antd-mobile/es/radio/style\";\nimport _Radio from \"antd-mobile/es/radio\";\nvar _jsxFileName = \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\hclient_mobile_react\\\\src\\\\components\\\\CasePicker\\\\index.js\";\nimport React, { Component } from 'react';\nimport Super from './../../super';\nimport './index.less';\nimport Units from './../../units';\nvar RadioItem = _Radio.RadioItem;\n\nvar CasePicker = /*#__PURE__*/function (_Component) {\n  _inherits(CasePicker, _Component);\n\n  function CasePicker() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CasePicker);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CasePicker)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      caseModal: false,\n      caseList: \"\",\n      changeselset: 0,\n      radiotvalue: \"\",\n      changeTag: false,\n      ikey: [],\n      tagStr: []\n    };\n\n    _this.showModal = function (formList) {\n      return function (e) {\n        console.log(formList);\n        document.addEventListener('touchmove', _this.bodyScroll, {\n          passive: false\n        });\n        var caseList = formList.value;\n        var tagStr = _this.state.tagStr;\n        var optGroupId = formList.optionGroupKey.split(\"@\")[0];\n        var num = formList.optionGroupKey.split(\"@\")[1];\n\n        if (caseList) {\n          tagStr = caseList.split(\"->\");\n          tagStr = Units.uniq(tagStr);\n        }\n\n        _this.setState({\n          caseModal: true,\n          caseList: caseList,\n          changeselset: 0,\n          radiokey: \"\",\n          num: num,\n          radiotvalue: \"\",\n          tagStr: tagStr\n        });\n\n        _this.getcaseList(optGroupId);\n      };\n    };\n\n    _this.getcaseList = function (optionKey) {\n      var ikey = _this.state.ikey;\n\n      if (typeof optionKey === \"string\") {\n        ikey.push(parseInt(optionKey));\n\n        _this.setState({\n          ikey: ikey\n        });\n      }\n\n      Super.super({\n        url: \"api2/meta/dict/cas_ops/\".concat(optionKey)\n      }).then(function (res) {\n        var ops = [];\n        res.options.forEach(function (item) {\n          var op = {};\n          op[\"value\"] = item.title;\n          op[\"label\"] = item.title;\n          op[\"key\"] = item.id;\n          ops.push(op);\n        });\n\n        _this.setState({\n          options: ops\n        });\n      });\n    };\n\n    _this.onChangeTag = function (selected, index, radiokey) {\n      var _this$state = _this.state,\n          radiotvalue = _this$state.radiotvalue,\n          ikey = _this$state.ikey;\n      var arr = radiotvalue.split(\"->\");\n      var arr2 = [];\n      var keys = [];\n      var res = \"\";\n\n      if (index > 0) {\n        //点击tag.删除点击tag之后的数据\n        for (var i = 0; i < index; i++) {\n          arr2.push(arr[i]);\n        }\n\n        res = arr2.join(\"->\");\n      }\n\n      for (var _i = 0; _i <= index; _i++) {\n        keys.push(ikey[_i]);\n      }\n\n      _this.getcaseList(radiokey);\n\n      _this.setState({\n        changeselset: index,\n        changeTag: true,\n        radiotvalue: res,\n        ikey: keys\n      });\n    };\n\n    _this.onRadioChange = function (radiokey, radiovalue) {\n      var _this$state2 = _this.state,\n          caseList = _this$state2.caseList,\n          radiotvalue = _this$state2.radiotvalue,\n          num = _this$state2.num,\n          changeselset = _this$state2.changeselset,\n          ikey = _this$state2.ikey,\n          tagStr = _this$state2.tagStr;\n      var changenum = changeselset;\n\n      if (radiotvalue) {\n        if (tagStr.length === parseInt(num)) {\n          var arr = radiotvalue.split(\"->\");\n          arr.splice(num - 1, 1, radiovalue);\n          radiotvalue = arr.join(\"->\");\n          caseList = radiotvalue;\n          ikey.push(radiokey);\n        } else {\n          caseList = radiotvalue + \"->\" + radiovalue;\n          radiotvalue = radiotvalue + \"->\" + radiovalue;\n          ikey.push(radiokey);\n          changenum++;\n        }\n      } else {\n        caseList = radiovalue;\n        radiotvalue = radiovalue;\n        ikey.push(radiokey);\n        changenum++;\n      }\n\n      if (caseList) {\n        tagStr = caseList.split(\"->\");\n        tagStr = Units.uniq(tagStr);\n      }\n\n      if (radiotvalue.split(\"->\").length < parseInt(num)) {\n        _this.getcaseList(radiokey);\n      } else if (radiotvalue.split(\"->\").length === parseInt(num)) {\n        ikey.splice(parseInt(num), 1, radiokey);\n      }\n\n      ikey = Units.uniq(ikey);\n\n      _this.setState({\n        radiokey: radiokey,\n        radiotvalue: radiotvalue,\n        caseList: caseList,\n        changeselset: changenum,\n        ikey: ikey,\n        tagStr: tagStr,\n        changeTag: false\n      });\n    };\n\n    _this.onCloseCase = function () {\n      var caseList = _this.state.caseList;\n      var formList = _this.props.formList;\n      formList.value = caseList; //最后按确定键，将值传出\n\n      _this.triggerChange(caseList);\n\n      _this.onClose();\n\n      _this.setState({\n        caseList: \"\",\n        changeselset: 0,\n        radiotvalue: \"\",\n        changeTag: false,\n        ikey: [],\n        tagStr: []\n      });\n    };\n\n    _this.triggerChange = function (changedValue) {\n      var onChange = _this.props.onChange;\n\n      if (onChange) {\n        onChange(changedValue);\n      }\n    };\n\n    _this.onClose = function () {\n      document.removeEventListener('touchmove', _this.bodyScroll, {\n        passive: false\n      });\n\n      _this.setState({\n        caseModal: false\n      });\n    };\n\n    _this.bodyScroll = function (e) {\n      e.preventDefault();\n    };\n\n    return _this;\n  }\n\n  _createClass(CasePicker, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var formList = this.props.formList;\n      var _this$state3 = this.state,\n          changeselset = _this$state3.changeselset,\n          caseModal = _this$state3.caseModal,\n          options = _this$state3.options,\n          radiokey = _this$state3.radiokey,\n          changeTag = _this$state3.changeTag,\n          ikey = _this$state3.ikey,\n          tagStr = _this$state3.tagStr;\n      var value = formList.value,\n          title = formList.title,\n          fieldId = formList.fieldId;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 4\n        }\n      }, /*#__PURE__*/React.createElement(_InputItem, {\n        value: value,\n        onClick: this.showModal(formList),\n        placeholder: \"\\u8BF7\\u9009\\u62E9\".concat(title),\n        key: fieldId,\n        editable: false,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 17\n        }\n      }, title), /*#__PURE__*/React.createElement(_Modal, {\n        popup: true,\n        visible: caseModal,\n        onClose: this.onClose,\n        animationType: \"slide-up\",\n        afterClose: this.closeModal,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(_List, {\n        renderHeader: function renderHeader() {\n          return /*#__PURE__*/React.createElement(\"div\", {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 47\n            }\n          }, \"\\u8BF7\\u9009\\u62E9\".concat(title));\n        },\n        className: \"popup-list\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(_List.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"tag\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 25\n        }\n      }, tagStr.map(function (item, index) {\n        return /*#__PURE__*/React.createElement(_Tag, {\n          selected: changeTag ? index === changeselset ? true : false : false //判断点击是否为当前\n          ,\n          onChange: function onChange(selected) {\n            return _this2.onChangeTag(selected, index, ikey[index]);\n          },\n          key: index,\n          disabled: index > changeselset ? true : false,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 33\n          }\n        }, item);\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"rediobox\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 25\n        }\n      }, options ? options.map(function (i) {\n        return /*#__PURE__*/React.createElement(RadioItem, {\n          key: i.key,\n          checked: radiokey === i.key,\n          onChange: function onChange() {\n            return _this2.onRadioChange(i.key, i.value);\n          },\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 33\n          }\n        }, i.label);\n      }) : \"\"), /*#__PURE__*/React.createElement(_List.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.onCloseCase,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 29\n        }\n      }, \"\\u786E\\u5B9A\")))));\n    }\n  }]);\n\n  return CasePicker;\n}(Component);\n\nexport { CasePicker as default };","map":{"version":3,"sources":["E:/我的文件/人员定位系统/hclient_mobile_react/src/components/CasePicker/index.js"],"names":["React","Component","Super","Units","RadioItem","CasePicker","state","caseModal","caseList","changeselset","radiotvalue","changeTag","ikey","tagStr","showModal","formList","e","console","log","document","addEventListener","bodyScroll","passive","value","optGroupId","optionGroupKey","split","num","uniq","setState","radiokey","getcaseList","optionKey","push","parseInt","super","url","then","res","ops","options","forEach","item","op","title","id","onChangeTag","selected","index","arr","arr2","keys","i","join","onRadioChange","radiovalue","changenum","length","splice","onCloseCase","props","triggerChange","onClose","changedValue","onChange","removeEventListener","preventDefault","fieldId","closeModal","map","key","label"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Modal, Button, Tag, Radio, InputItem, List } from 'antd-mobile';\r\nimport Super from './../../super'\r\nimport './index.less'\r\nimport Units from './../../units'\r\nconst RadioItem = Radio.RadioItem;\r\n\r\nexport default class CasePicker extends Component {\r\n\r\n\tstate = {\r\n\t\tcaseModal: false,\r\n\t\tcaseList: \"\",\r\n\t\tchangeselset: 0,\r\n\t\tradiotvalue: \"\",\r\n\t\tchangeTag: false,\r\n\t\tikey: [],\r\n\t\ttagStr: []\r\n\t}\r\n\tshowModal = (formList) => (e) => {\r\n\t\tconsole.log(formList)\r\n\t\tdocument.addEventListener('touchmove', this.bodyScroll, {\r\n\t\t\tpassive: false\r\n\t\t})\r\n\t\tlet caseList = formList.value\r\n\t\tlet {tagStr} = this.state\r\n\t\tconst optGroupId = formList.optionGroupKey.split(\"@\")[0]\r\n\t\tconst num = formList.optionGroupKey.split(\"@\")[1]\r\n\t\tif(caseList) {\r\n\t\t\ttagStr = caseList.split(\"->\")\r\n\t\t\ttagStr = Units.uniq(tagStr)\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tcaseModal: true,\r\n\t\t\tcaseList,\r\n\t\t\tchangeselset: 0,\r\n\t\t\tradiokey: \"\",\r\n\t\t\tnum,\r\n\t\t\tradiotvalue: \"\",\r\n\t\t\ttagStr,\r\n\t\t});\r\n\t\tthis.getcaseList(optGroupId)\r\n\t}\r\n\r\n\tgetcaseList = (optionKey) => {\r\n\t\tlet {ikey} = this.state\r\n\t\tif(typeof optionKey === \"string\") {\r\n\t\t\tikey.push(parseInt(optionKey))\r\n\t\t\tthis.setState({\r\n\t\t\t\tikey\r\n\t\t\t})\r\n\t\t}\r\n\t\tSuper.super({\r\n\t\t\turl: `api2/meta/dict/cas_ops/${optionKey}`,\r\n\t\t}).then((res) => {\r\n\t\t\tconst ops = []\r\n\t\t\tres.options.forEach((item) => {\r\n\t\t\t\tconst op = {}\r\n\t\t\t\top[\"value\"] = item.title\r\n\t\t\t\top[\"label\"] = item.title\r\n\t\t\t\top[\"key\"] = item.id\r\n\t\t\t\tops.push(op)\r\n\t\t\t})\r\n\t\t\tthis.setState({\r\n\t\t\t\toptions: ops,\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\tonChangeTag = (selected, index, radiokey) => {\r\n\t\tlet {\r\n\t\t\tradiotvalue,\r\n\t\t\tikey\r\n\t\t} = this.state\r\n\t\tconst arr = radiotvalue.split(\"->\")\r\n\t\tconst arr2 = []\r\n\t\tconst keys = []\r\n\t\tlet res = \"\"\r\n\t\tif(index > 0) { //点击tag.删除点击tag之后的数据\r\n\t\t\tfor(let i = 0; i < index; i++) {\r\n\t\t\t\tarr2.push(arr[i])\r\n\t\t\t}\r\n\t\t\tres = arr2.join(\"->\")\r\n\t\t}\r\n\t\tfor(let i = 0; i <= index; i++) {\r\n\t\t\tkeys.push(ikey[i])\r\n\t\t}\r\n\t\tthis.getcaseList(radiokey)\r\n\t\tthis.setState({\r\n\t\t\tchangeselset: index,\r\n\t\t\tchangeTag: true,\r\n\t\t\tradiotvalue: res,\r\n\t\t\tikey: keys\r\n\t\t})\r\n\t}\r\n\tonRadioChange = (radiokey, radiovalue) => {\r\n\t\tlet {\r\n\t\t\tcaseList,\r\n\t\t\tradiotvalue,\r\n\t\t\tnum,\r\n\t\t\tchangeselset,\r\n\t\t\tikey,\r\n\t\t\ttagStr\r\n\t\t} = this.state\r\n\t\tlet changenum = changeselset\r\n\t\tif(radiotvalue) {\r\n\t\t\tif(tagStr.length === parseInt(num)) {\r\n\t\t\t\tconst arr = radiotvalue.split(\"->\")\r\n\t\t\t\tarr.splice(num - 1, 1, radiovalue)\r\n\t\t\t\tradiotvalue = arr.join(\"->\")\r\n\t\t\t\tcaseList = radiotvalue\r\n\t\t\t\tikey.push(radiokey)\r\n\t\t\t} else {\r\n\t\t\t\tcaseList = radiotvalue + \"->\" + radiovalue\r\n\t\t\t\tradiotvalue = radiotvalue + \"->\" + radiovalue\r\n\t\t\t\tikey.push(radiokey)\r\n\t\t\t\tchangenum++\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcaseList = radiovalue\r\n\t\t\tradiotvalue = radiovalue\r\n\t\t\tikey.push(radiokey)\r\n\t\t\tchangenum++\r\n\t\t}\r\n\t\tif(caseList) {\r\n\t\t\ttagStr = caseList.split(\"->\")\r\n\t\t\ttagStr = Units.uniq(tagStr)\r\n\t\t}\r\n\t\tif(radiotvalue.split(\"->\").length < parseInt(num)) {\r\n\t\t\tthis.getcaseList(radiokey)\r\n\t\t} else if(radiotvalue.split(\"->\").length === parseInt(num)) {\r\n\t\t\tikey.splice(parseInt(num), 1, radiokey)\r\n\t\t}\r\n\t\tikey = Units.uniq(ikey)\r\n\t\tthis.setState({\r\n\t\t\tradiokey,\r\n\t\t\tradiotvalue,\r\n\t\t\tcaseList,\r\n\t\t\tchangeselset: changenum,\r\n\t\t\tikey,\r\n\t\t\ttagStr,\r\n\t\t\tchangeTag: false\r\n\t\t});\r\n\t};\r\n\tonCloseCase = () => {\r\n\t\tlet {caseList} = this.state\r\n\t\tlet {formList} = this.props\r\n\t\tformList.value = caseList //最后按确定键，将值传出\r\n\t\tthis.triggerChange(caseList);\r\n\t\tthis.onClose()\r\n\t\tthis.setState({\r\n\t\t\tcaseList: \"\",\r\n\t\t\tchangeselset: 0,\r\n\t\t\tradiotvalue: \"\",\r\n\t\t\tchangeTag: false,\r\n\t\t\tikey: [],\r\n\t\t\ttagStr: []\r\n\t\t})\r\n\t}\r\n\ttriggerChange = (changedValue) => {\r\n\t\tconst onChange = this.props.onChange;\r\n\t\tif(onChange) {\r\n\t\t\tonChange(changedValue);\r\n\t\t}\r\n\t}\r\n\tonClose = () => {\r\n\t\tdocument.removeEventListener('touchmove', this.bodyScroll, {\r\n\t\t\tpassive: false\r\n\t\t})\r\n\t\tthis.setState({\r\n\t\t\tcaseModal: false,\r\n\t\t});\r\n\t}\r\n\tbodyScroll = (e) => {\r\n\t\te.preventDefault();\r\n\t}\r\n\trender() {\r\n\t\tconst {formList} = this.props\r\n\t\tconst {changeselset,caseModal,options,radiokey,changeTag,ikey,tagStr} = this.state\r\n\t\tconst {value,title,fieldId} = formList\r\n\t\treturn(\r\n\t\t\t<div>\r\n                <InputItem\r\n                    value={value}\r\n                    onClick={this.showModal(formList)}\r\n                    placeholder={`请选择${title}`}\r\n                    key={fieldId}\r\n                    editable={false}\r\n                >{title}</InputItem>\r\n                <Modal\r\n                    popup\r\n                    visible={caseModal}\r\n                    onClose={this.onClose}\r\n                    animationType=\"slide-up\"\r\n                    afterClose={this.closeModal}\r\n                    >\r\n                    <List renderHeader={() => <div>{`请选择${title}`}</div>} className=\"popup-list\">\r\n                    <List.Item>\r\n                        <div className=\"tag\">\r\n                            {tagStr.map((item,index)=>\r\n                                <Tag \r\n                                    selected={changeTag?(index===changeselset?true:false):false} //判断点击是否为当前\r\n                                    onChange={(selected) =>this.onChangeTag(selected, index,ikey[index])} \r\n                                    key={index}\r\n                                    disabled={index>changeselset?true:false}\r\n                                    >\r\n                                    {item}\r\n                                </Tag>\r\n                            )}\r\n                        </div>\r\n                        </List.Item>\r\n                        <div className=\"rediobox\">\r\n                            {options?options.map(i => \r\n                                <RadioItem key={i.key} checked={radiokey === i.key} onChange={() => this.onRadioChange(i.key,i.value)}>\r\n                                    {i.label}\r\n                                </RadioItem>\r\n                            ):\"\"}\r\n                        </div>\r\n                        <List.Item>\r\n                            <Button type=\"primary\" onClick={this.onCloseCase}>确定</Button>\r\n                        </List.Item>\r\n                    </List>\r\n                </Modal>\r\n            </div>\r\n\t\t)\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}