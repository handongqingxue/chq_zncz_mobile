{"ast":null,"code":"import \"antd-mobile/es/toast/style\";\nimport _Toast from \"antd-mobile/es/toast\";\nimport _classCallCheck from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\src\\\\pages\\\\fixedSet\\\\index.js\";\nimport { withRouter } from \"react-router-dom\";\nimport React, { Component } from \"react\";\nimport \"./index.less\";\nimport Super from \"../../super\";\nimport $ from \"jquery\";\n\nvar FixedSet = /*#__PURE__*/function (_Component) {\n  _inherits(FixedSet, _Component);\n\n  function FixedSet() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, FixedSet);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(FixedSet)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      menuId: 96653404938261,\n      code: \"98972186405904392\",\n      groupsList: [],\n      selectList: [],\n      fieldItemList: []\n    };\n\n    _this.request = function () {\n      Super.super({\n        url: \"api2/meta/tmpl/\".concat(_this.state.menuId, \"/dtmpl/normal/\"),\n        method: 'GET'\n      }).then(function (res) {\n        //console.log(res)\n        var groupsList = res.config.dtmpl.groups; //console.log(groupsList[0].title)\n\n        var selectId = [];\n        groupsList.map(function (item, index) {\n          item.fields.map(function (it) {\n            if (it.type == \"select\" || it.type == \"label\") selectId.push(it.fieldId);\n          });\n        });\n\n        _this.setState({\n          groupsList: groupsList\n        });\n\n        Super.super({\n          url: \"api2/meta/dict/field_options\",\n          data: {\n            fieldIds: selectId.join(',')\n          }\n        }).then(function (res) {\n          //console.log(JSON.stringify(res))\n          var selectList = [];\n          var optionsMap = res.optionsMap;\n\n          for (var key in optionsMap) {\n            selectList[key] = optionsMap[key]; //console.log(\"selectList==\"+JSON.stringify(selectList[key]))\n          }\n\n          _this.setState({\n            selectList: selectList\n          });\n\n          _this.initDetail();\n        });\n      });\n    };\n\n    _this.initDetail = function () {\n      Super.super({\n        url: \"api2/entity/\".concat(_this.state.menuId, \"/detail/\").concat(_this.state.code),\n        method: 'GET'\n      }).then(function (resi) {\n        var fieldMap = resi.entity.fieldMap; //console.log(\"resi.fieldMap===\"+JSON.stringify(fieldMap))\n\n        for (var key in fieldMap) {\n          _this.state.fieldItemList[key] = fieldMap[key];\n        }\n\n        _this.initData();\n      });\n    };\n\n    _this.initData = function () {\n      var groupsList = _this.state.groupsList;\n      var fieldItemList = _this.state.fieldItemList;\n      groupsList.map(function (item, index) {\n        var fields = item.fields;\n        fields.map(function (fieldItem, fieldIndex) {\n          if (fieldItem.type == \"select\") {\n            $(\"#field_item_select\" + fieldItem.id + \" option[value='\" + fieldItemList[fieldItem.id] + \"']\").attr(\"selected\", true);\n          } else {\n            $(\"#field_item_input\" + fieldItem.id).val(fieldItemList[fieldItem.id]);\n          }\n        });\n      });\n    };\n\n    _this.submit = function () {\n      var data = {};\n      data['唯一编码'] = _this.state.code;\n      var groupsList = _this.state.groupsList;\n      groupsList.map(function (item, index) {\n        var fields = item.fields;\n        fields.map(function (fieldItem, fieldIndex) {\n          if (fieldItem.type == \"select\") {\n            console.log(fieldItem.title + \",\" + $(\"#field_item_select\" + fieldItem.id).val());\n            data[fieldItem.title] = $(\"#field_item_select\" + fieldItem.id).val();\n          } else {\n            console.log(fieldItem.title + \",\" + $(\"#field_item_input\" + fieldItem.id).val());\n            data[fieldItem.title] = $(\"#field_item_input\" + fieldItem.id).val();\n          }\n        });\n      });\n      console.log(data); //return false;\n\n      Super.super({\n        url: \"api2/entity/\".concat(_this.state.menuId, \"/detail/normal\"),\n        method: 'POST',\n        data: data\n      }).then(function (res) {\n        //console.log(JSON.stringify(res))\n        if (res && res.status === \"suc\") {\n          _Toast.success(\"保存成功！\");\n\n          _this.goPage('home');\n        } else {\n          _Toast.fail(\"保存失败!\");\n        }\n      });\n    };\n\n    _this.goPage = function (value) {\n      _this.props.history.push(\"/\".concat(value));\n    };\n\n    return _this;\n  }\n\n  _createClass(FixedSet, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      $(\"html\").css(\"background-color\", \"#EDEDED\");\n      this.request();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          groupsList = _this$state.groupsList,\n          selectList = _this$state.selectList,\n          fieldItemList = _this$state.fieldItemList;\n      var _this$state2 = this.state,\n          itemDiv = _this$state2.itemDiv,\n          itemFields = _this$state2.itemFields,\n          fieldDiv = _this$state2.fieldDiv;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"fsPage_div\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 16\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"top_div\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }\n      }, \"\\u5B9A\\u4F4D\\u914D\\u7F6E\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"back_but_div\",\n        onClick: this.goPage.bind(this, 'home'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 13\n        }\n      }, \"<\\u8FD4\\u56DE\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"groups_list_div\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 13\n        }\n      }, groupsList.map(function (item, index) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: \"groups_item_div\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 32\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"title_div\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 29\n          }\n        }, item.title), item.fields.map(function (fieldItem, fieldIndex) {\n          return /*#__PURE__*/React.createElement(\"div\", {\n            className: \"field_item_div\",\n            fieldId: fieldItem.fieldId,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 48\n            }\n          }, /*#__PURE__*/React.createElement(\"div\", {\n            className: \"title_div\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 45\n            }\n          }, fieldItem.title), /*#__PURE__*/React.createElement(\"div\", {\n            className: \"value_div\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 45\n            }\n          }, fieldItem.type == \"select\" ? /*#__PURE__*/React.createElement(\"select\", {\n            id: 'field_item_select' + fieldItem.id,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 53\n            }\n          }, selectList[fieldItem.fieldId] ? selectList[fieldItem.fieldId].map(function (selectItem, selectIndex) {\n            return /*#__PURE__*/React.createElement(\"option\", {\n              value: selectItem.value,\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 76\n              }\n            }, selectItem.title);\n          }) : /*#__PURE__*/React.createElement(\"option\", {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 65\n            }\n          }, \"\\u6682\\u65E0\")) : /*#__PURE__*/React.createElement(\"input\", {\n            id: 'field_item_input' + fieldItem.id,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 53\n            }\n          })));\n        }));\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"submitBut_div\",\n        onClick: this.submit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 13\n        }\n      }, \"\\u4FDD\\u5B58\"));\n    }\n  }]);\n\n  return FixedSet;\n}(Component);\n\nexport default withRouter(FixedSet);","map":{"version":3,"sources":["E:/我的文件/人员定位系统/chq_position_app/src/pages/fixedSet/index.js"],"names":["withRouter","React","Component","Super","$","FixedSet","state","menuId","code","groupsList","selectList","fieldItemList","request","super","url","method","then","res","config","dtmpl","groups","selectId","map","item","index","fields","it","type","push","fieldId","setState","data","fieldIds","join","optionsMap","key","initDetail","resi","fieldMap","entity","initData","fieldItem","fieldIndex","id","attr","val","submit","console","log","title","status","success","goPage","fail","value","props","history","css","itemDiv","itemFields","fieldDiv","bind","selectItem","selectIndex"],"mappings":"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","sourcesContent":["import {withRouter} from \"react-router-dom\";\r\nimport React, {Component} from \"react\";\r\nimport \"./index.less\";\r\nimport Super from \"../../super\";\r\nimport $ from \"jquery\";\r\nimport {Toast} from \"antd-mobile\";\r\n\r\nclass FixedSet extends Component{\r\n    state={menuId:96653404938261,code:\"98972186405904392\",groupsList:[],selectList:[],fieldItemList:[]}\r\n\r\n    componentDidMount(){\r\n        $(\"html\").css(\"background-color\",\"#EDEDED\");\r\n        this.request();\r\n    }\r\n    request=()=>{\r\n        Super.super({\r\n            url:`api2/meta/tmpl/${this.state.menuId}/dtmpl/normal/`,\r\n            method:'GET',\r\n        }).then((res) => {\r\n            //console.log(res)\r\n            let groupsList=res.config.dtmpl.groups;\r\n            //console.log(groupsList[0].title)\r\n            let selectId=[];\r\n            groupsList.map((item,index)=>{\r\n                item.fields.map((it)=>{\r\n                    if(it.type==\"select\"||it.type==\"label\")\r\n                        selectId.push(it.fieldId);\r\n                })\r\n            });\r\n            this.setState({groupsList:groupsList});\r\n\r\n            Super.super({\r\n                url:`api2/meta/dict/field_options`,\r\n                data:{\r\n                    fieldIds:selectId.join(',')\r\n                },\r\n            }).then((res)=>{\r\n                //console.log(JSON.stringify(res))\r\n                let selectList=[];\r\n                let optionsMap=res.optionsMap;\r\n                for(let key in optionsMap){\r\n                    selectList[key]=optionsMap[key]\r\n                    //console.log(\"selectList==\"+JSON.stringify(selectList[key]))\r\n                }\r\n                this.setState({selectList:selectList});\r\n                this.initDetail()\r\n            });\r\n        });\r\n    }\r\n    initDetail=()=>{\r\n        Super.super({\r\n            url:`api2/entity/${this.state.menuId}/detail/${this.state.code}`,\r\n            method:'GET',\r\n        }).then((resi)=>{\r\n            let fieldMap=resi.entity.fieldMap;\r\n            //console.log(\"resi.fieldMap===\"+JSON.stringify(fieldMap))\r\n            for(let key in fieldMap){\r\n                this.state.fieldItemList[key]=fieldMap[key];\r\n            }\r\n            this.initData()\r\n        });\r\n    }\r\n    initData=()=>{\r\n        let groupsList=this.state.groupsList;\r\n        let fieldItemList=this.state.fieldItemList;\r\n        groupsList.map((item,index)=>{\r\n            let fields=item.fields;\r\n            fields.map((fieldItem,fieldIndex)=>{\r\n                if(fieldItem.type==\"select\"){\r\n                    $(\"#field_item_select\"+fieldItem.id+\" option[value='\"+fieldItemList[fieldItem.id]+\"']\").attr(\"selected\",true)\r\n                }\r\n                else {\r\n                    $(\"#field_item_input\"+fieldItem.id).val(fieldItemList[fieldItem.id])\r\n                }\r\n            });\r\n        });\r\n    }\r\n    submit=()=>{\r\n        let data={};\r\n        data['唯一编码']=this.state.code;\r\n        let groupsList=this.state.groupsList;\r\n        groupsList.map((item,index)=>{\r\n            let fields=item.fields;\r\n            fields.map((fieldItem,fieldIndex)=>{\r\n                if(fieldItem.type==\"select\"){\r\n                    console.log(fieldItem.title+\",\"+$(\"#field_item_select\"+fieldItem.id).val())\r\n                    data[fieldItem.title]=$(\"#field_item_select\"+fieldItem.id).val();\r\n                }\r\n                else{\r\n                    console.log(fieldItem.title+\",\"+$(\"#field_item_input\"+fieldItem.id).val())\r\n                    data[fieldItem.title]=$(\"#field_item_input\"+fieldItem.id).val();\r\n                }\r\n            });\r\n        });\r\n        console.log(data)\r\n        //return false;\r\n        Super.super({\r\n            url:`api2/entity/${this.state.menuId}/detail/normal`,\r\n            method:'POST',\r\n            data:data\r\n        }).then((res)=>{\r\n            //console.log(JSON.stringify(res))\r\n            if(res && res.status===\"suc\") {\r\n                Toast.success(\"保存成功！\")\r\n                this.goPage('home')\r\n            }\r\n            else{\r\n                Toast.fail(\"保存失败!\")\r\n            }\r\n        })\r\n    }\r\n    goPage=(value)=>{\r\n        this.props.history.push(`/${value}`);\r\n    }\r\n    render() {\r\n        const {groupsList,selectList,fieldItemList}=this.state\r\n        let {itemDiv,itemFields,fieldDiv}=this.state\r\n        return <div className=\"fsPage_div\">\r\n            <div className=\"top_div\">定位配置</div>\r\n            <div className=\"back_but_div\" onClick={this.goPage.bind(this,'home')}>&lt;返回</div>\r\n            <div className=\"groups_list_div\">\r\n                {\r\n                    groupsList.map((item,index)=>{\r\n                        return <div className=\"groups_item_div\">\r\n                            <div className=\"title_div\">{item.title}</div>\r\n                                {\r\n                                    item.fields.map((fieldItem,fieldIndex)=>{\r\n                                        return <div className=\"field_item_div\" fieldId={fieldItem.fieldId}>\r\n                                            <div className=\"title_div\">{fieldItem.title}</div>\r\n                                            {/*<div>{fieldItem.id}-{fieldItem.type}</div>*/}\r\n                                            <div className=\"value_div\">\r\n                                                {fieldItem.type==\"select\"\r\n                                                    ?\r\n                                                    <select id={'field_item_select'+fieldItem.id}>\r\n                                                        {\r\n                                                            selectList[fieldItem.fieldId]\r\n                                                                ?\r\n                                                                selectList[fieldItem.fieldId].map((selectItem,selectIndex)=>{\r\n                                                                    return <option value={selectItem.value}>{selectItem.title}</option>\r\n                                                                })\r\n                                                                :\r\n                                                                <option>暂无</option>\r\n                                                        }\r\n                                                    </select>\r\n                                                    :\r\n                                                    <input id={'field_item_input'+fieldItem.id}/>\r\n                                                }\r\n                                            </div>\r\n                                        </div>\r\n                                    })\r\n                                }\r\n                        </div>\r\n                    })\r\n                }\r\n            </div>\r\n            <div className=\"submitBut_div\" onClick={this.submit}>保存</div>\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport default withRouter(FixedSet)"]},"metadata":{},"sourceType":"module"}