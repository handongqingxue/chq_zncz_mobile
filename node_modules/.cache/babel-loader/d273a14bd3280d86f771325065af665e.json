{"ast":null,"code":"import \"antd-mobile/es/activity-indicator/style\";\nimport _ActivityIndicator from \"antd-mobile/es/activity-indicator\";\nimport \"antd-mobile/es/drawer/style\";\nimport _Drawer from \"antd-mobile/es/drawer\";\nimport \"antd-mobile/es/card/style\";\nimport _Card from \"antd-mobile/es/card\";\nimport \"antd-mobile/es/button/style\";\nimport _Button from \"antd-mobile/es/button\";\nimport \"antd-mobile/es/toast/style\";\nimport _Toast from \"antd-mobile/es/toast\";\nimport _classCallCheck from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport \"antd-mobile/es/modal/style\";\nimport _Modal from \"antd-mobile/es/modal\";\nimport \"antd-mobile/es/popover/style\";\nimport _Popover from \"antd-mobile/es/popover\";\nimport \"antd-mobile/es/list/style\";\nimport _List from \"antd-mobile/es/list\";\nvar _jsxFileName = \"E:\\\\\\u6211\\u7684\\u6587\\u4EF6\\\\\\u4EBA\\u5458\\u5B9A\\u4F4D\\u7CFB\\u7EDF\\\\chq_position_app\\\\src\\\\pages\\\\actTable\\\\index.js\";\nimport React, { Component } from 'react';\nimport Nav from './../../components/Nav';\nimport SearchForm from './../../components/SearchForm';\nimport Super from './../../super';\nimport Units from './../../units';\nimport './index.less';\nimport Storage from './../../units/storage';\nvar Item = _List.Item;\nvar Itempop = _Popover.Item;\nvar alert = _Modal.alert;\n\nvar ActTable = /*#__PURE__*/function (_Component) {\n  _inherits(ActTable, _Component);\n\n  function ActTable() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ActTable);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ActTable)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      menuTitle: '',\n      showDrawer: false,\n      searchList: [],\n      optArr: {},\n      animating: false,\n      menuId: _this.props.match.params.menuId\n    };\n\n    _this.requestList = function (menuId, data, isPushUrl) {\n      console.log(\"menuId===\" + menuId);\n\n      _this.setState({\n        animating: true\n      });\n\n      if (data && data.pageNo && data.pageSize && !isPushUrl) {\n        _this.props.history.push(\"/\".concat(menuId, \"?pageNo=\").concat(data.pageNo, \"&pageSize=\").concat(data.pageSize));\n      }\n\n      Super.super({\n        url: \"api2/entity/\".concat(menuId, \"/list/tmpl\"),\n        method: 'GET',\n        data: data\n      }).then(function (res) {\n        document.removeEventListener('touchmove', _this.bodyScroll, {\n          passive: false\n        });\n\n        if (res) {\n          console.log(\"requestList===\" + JSON.stringify(res));\n          console.log(\"columns===\" + res.ltmpl.columns);\n          var fieldIds = [];\n          res.ltmpl.criterias.forEach(function (item) {\n            if (item.inputType === \"select\") {\n              fieldIds.push(item.fieldId);\n            }\n\n            var criteriaValueMap = res.criteriaValueMap;\n\n            for (var k in criteriaValueMap) {\n              if (k === item.id.toString()) {\n                item.value = criteriaValueMap[k];\n              }\n            }\n          });\n          window.scrollTo(0, 0);\n\n          _this.setState({\n            menuTitle: res.menu.title,\n            listLtmpl: res.ltmpl.columns,\n            queryKey: res.queryKey,\n            searchList: res.ltmpl.criterias,\n            showDrawer: false,\n            searchFieldIds: fieldIds,\n            animating: false\n          });\n\n          if (Storage[\"\".concat(menuId)] && !data) {\n            var _res = Storage[\"\".concat(menuId)];\n\n            _this.sessionTodo(_res);\n          } else {\n            _this.queryList(res.queryKey, data);\n          }\n        }\n      });\n    };\n\n    _this.queryList = function (queryKey, data) {\n      var menuId = _this.state.menuId;\n      Super.super({\n        url: \"api2/entity/list/\".concat(queryKey, \"/data\"),\n        method: 'GET',\n        data: data\n      }).then(function (res) {\n        console.log(\"res===\" + JSON.stringify(res));\n        Storage[\"\".concat(menuId)] = res;\n\n        _this.sessionTodo(res);\n      });\n    };\n\n    _this.sessionTodo = function (data) {\n      console.log(\"sessionTodo===\" + JSON.stringify(data));\n      var listLtmpl = _this.state.listLtmpl;\n      var isStat = true;\n      data.entities.forEach(function (item) {\n        item.fields = [];\n        listLtmpl.forEach(function (it) {\n          for (var k in item.cellMap) {\n            if (it.title === \"操作\") {\n              isStat = false;\n            }\n\n            if (k === it.id.toString()) {\n              var list = {\n                title: it.title,\n                value: item.cellMap[k]\n              };\n              item.fields.push(list);\n            }\n          }\n        });\n      });\n\n      _this.setState({\n        list: data.entities,\n        isStat: isStat,\n        //判断列表是否是统计页\n        pageInfo: data.pageInfo,\n        currentPage: data.pageInfo.pageNo,\n        isSeeTotal: undefined,\n        Loading: false,\n        pageSize: data.pageInfo.pageSize\n      });\n    };\n\n    _this.handlePop = function (value) {\n      var menuId = _this.state.menuId;\n\n      if (value === \"search\") {\n        _this.onOpenChange();\n\n        _this.getSearchOptions();\n      } else if (value === \"create\") {\n        _this.props.history.push(\"/create/\".concat(menuId));\n      } else {\n        _this.props.history.push(\"/\".concat(value));\n      }\n    };\n\n    _this.getSearchOptions = function () {\n      var searchFieldIds = _this.state.searchFieldIds;\n\n      if (searchFieldIds.length > 0) {\n        Super.super({\n          url: \"api2/meta/dict/field_options\",\n          data: {\n            fieldIds: searchFieldIds\n          }\n        }).then(function (res) {\n          _this.setState({\n            optArr: res.optionsMap\n          });\n        });\n      }\n    };\n\n    _this.cardClick = function (code) {\n      var menuId = _this.state.menuId;\n\n      _this.props.history.push(\"/\".concat(menuId, \"/\").concat(code));\n    };\n\n    _this.bodyScroll = function (e) {\n      e.preventDefault();\n    };\n\n    _this.onOpenChange = function () {\n      var showDrawer = _this.state.showDrawer; //console.log(showDrawer);\n\n      _this.setState({\n        showDrawer: !showDrawer\n      });\n\n      if (showDrawer) {\n        //固定页面\n        document.removeEventListener('touchmove', _this.bodyScroll, {\n          passive: false\n        });\n      } else {\n        document.addEventListener('touchmove', _this.bodyScroll, {\n          passive: false\n        });\n      }\n    };\n\n    _this.goPage = function (no) {\n      var _this$state = _this.state,\n          pageInfo = _this$state.pageInfo,\n          menuId = _this$state.menuId,\n          searchwords = _this$state.searchwords;\n      var data = {};\n      var topageNo = pageInfo.pageNo + no;\n      data.pageNo = topageNo;\n      data.pageSize = pageInfo.pageSize;\n\n      for (var k in searchwords) {\n        if (searchwords[k]) {\n          data[k] = searchwords[k];\n        }\n      }\n\n      _this.requestList(menuId, data);\n\n      window.scrollTo(0, 0);\n    };\n\n    _this.handleSearch = function (values) {\n      var menuId = _this.state.menuId;\n\n      _this.requestList(menuId, values);\n\n      _this.setState({\n        searchwords: values\n      });\n    };\n\n    _this.showAlert = function (code, e) {\n      e.stopPropagation();\n      var alertInstance = alert('删除操作', '确认删除这条记录吗???', [{\n        text: '取消'\n      }, {\n        text: '确认',\n        onPress: function onPress() {\n          return _this.handelDelete(code);\n        }\n      }]);\n      setTimeout(function () {\n        // 可以调用close方法以在外部close\n        alertInstance.close();\n      }, 10000);\n    };\n\n    _this.handelDelete = function (code) {\n      var menuId = _this.state.menuId;\n      Super.super({\n        url: \"api2/entity/\".concat(menuId, \"/detail\"),\n        method: 'DELETE',\n        data: {\n          codes: code\n        }\n      }).then(function (res) {\n        _this.setState({\n          loading: false,\n          Loading: false\n        });\n\n        if (res.status === \"suc\") {\n          _Toast.success(\"删除成功！\"); //刷新列表 \n\n\n          _this.requestList(menuId, code);\n        } else {\n          _Toast.info('删除失败！');\n        }\n      });\n    };\n\n    _this.seeTotal = function () {\n      var _this$state2 = _this.state,\n          queryKey = _this$state2.queryKey,\n          isSeeTotal = _this$state2.isSeeTotal;\n\n      if (!isSeeTotal) {\n        Super.super({\n          url: \"api2/entity/list/\".concat(queryKey, \"/count\"),\n          method: 'GET'\n        }).then(function (res) {\n          _this.setState({\n            isSeeTotal: res.count\n          });\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(ActTable, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var menuId = this.state.menuId;\n      this.requestList(menuId);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearTimeout(this.closeTimer);\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var menuId = nextProps.match.params.menuId;\n      this.setState({\n        menuId: menuId\n      });\n      var url = decodeURI(this.props.history.location.search); //获取url参数(页码)，并解码\n\n      if (url) {\n        this.requestList(menuId, Units.urlToObj(url), true);\n      } else {\n        Storage[\"\".concat(menuId)] = null; //刷新列表数据\n\n        this.requestList(menuId);\n      }\n    } //isPushUrl=true时，后退获得的url已有参数，不需要push链接,不然会报错\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state3 = this.state,\n          menuTitle = _this$state3.menuTitle,\n          list = _this$state3.list,\n          showDrawer = _this$state3.showDrawer,\n          searchList = _this$state3.searchList,\n          optArr = _this$state3.optArr,\n          pageInfo = _this$state3.pageInfo,\n          animating = _this$state3.animating,\n          isSeeTotal = _this$state3.isSeeTotal,\n          isStat = _this$state3.isStat;\n      var data = Storage.menuList;\n      var actPop;\n\n      if (isStat) {\n        actPop = [/*#__PURE__*/React.createElement(Itempop, {\n          key: \"5\",\n          value: \"home\",\n          icon: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"iconfont\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 42\n            }\n          }, \"\\uE62F\"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 6\n          }\n        }, \"\\u9996\\u9875\"), /*#__PURE__*/React.createElement(Itempop, {\n          key: \"1\",\n          value: \"user\",\n          icon: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"iconfont\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 42\n            }\n          }, \"\\uE74C\"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 6\n          }\n        }, \"\\u7528\\u6237\"), /*#__PURE__*/React.createElement(Itempop, {\n          key: \"3\",\n          value: \"search\",\n          icon: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"iconfont\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 44\n            }\n          }, \"\\uE72F\"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 6\n          }\n        }, \"\\u7B5B\\u9009\"), /*#__PURE__*/React.createElement(Itempop, {\n          key: \"2\",\n          value: \"login\",\n          icon: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"iconfont\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 43\n            }\n          }, \"\\uE739\"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 6\n          }\n        }, \"\\u9000\\u51FA\")];\n      } else {\n        actPop = [/*#__PURE__*/React.createElement(Itempop, {\n          key: \"5\",\n          value: \"home\",\n          icon: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"iconfont\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 42\n            }\n          }, \"\\uE62F\"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 6\n          }\n        }, \"\\u9996\\u9875\"), /*#__PURE__*/React.createElement(Itempop, {\n          key: \"1\",\n          value: \"user\",\n          icon: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"iconfont\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 42\n            }\n          }, \"\\uE74C\"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 6\n          }\n        }, \"\\u7528\\u6237\"), /*#__PURE__*/React.createElement(Itempop, {\n          key: \"3\",\n          value: \"search\",\n          icon: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"iconfont\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 44\n            }\n          }, \"\\uE72F\"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 6\n          }\n        }, \"\\u7B5B\\u9009\"), /*#__PURE__*/React.createElement(Itempop, {\n          key: \"4\",\n          value: \"create\",\n          icon: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"iconfont\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 44\n            }\n          }, \"\\uE60A\"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 6\n          }\n        }, \"\\u521B\\u5EFA\"), /*#__PURE__*/React.createElement(Itempop, {\n          key: \"2\",\n          value: \"login\",\n          icon: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"iconfont\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 43\n            }\n          }, \"\\uE739\"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 6\n          }\n        }, \"\\u9000\\u51FA\")];\n      }\n\n      var sidebar = /*#__PURE__*/React.createElement(SearchForm, {\n        searchList: searchList,\n        optArr: optArr,\n        handleSearch: this.handleSearch,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 20\n        }\n      });\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"actTable\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 4\n        }\n      }, /*#__PURE__*/React.createElement(Nav, {\n        title: menuTitle,\n        data: data,\n        handleSelected: this.handlePop,\n        pops: actPop,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"topbox\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 17\n        }\n      }, pageInfo && pageInfo.pageNo !== 1 ? /*#__PURE__*/React.createElement(_Button, {\n        size: \"small\",\n        inline: true,\n        onClick: function onClick() {\n          return _this2.goPage(-1);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 21\n        }\n      }, \"\\u4E0A\\u4E00\\u9875\") : \"\", /*#__PURE__*/React.createElement(\"span\", {\n        className: \"pageNo\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 21\n        }\n      }, pageInfo ? \"\\u7B2C\".concat(pageInfo.pageNo, \"\\u9875\\uFF0C\") : \"\", isSeeTotal !== undefined ? \"\\u5171\".concat(isSeeTotal, \"\\u6761\") : /*#__PURE__*/React.createElement(\"span\", {\n        onClick: this.seeTotal,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 49\n        }\n      }, \"\\u70B9\\u51FB\\u67E5\\u770B\\u603B\\u6570\"))), list ? list.map(function (item, index) {\n        return /*#__PURE__*/React.createElement(_Card, {\n          key: item.code,\n          onClick: isStat ? function () {\n            return _Toast.info(\"无详情页\");\n          } : function () {\n            return _this2.cardClick(item.code);\n          },\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(_Card.Header, {\n          title: /*#__PURE__*/React.createElement(\"span\", {\n            style: {\n              color: \"#ccc\"\n            },\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 18\n            }\n          }, pageInfo ? (pageInfo.pageNo - 1) * pageInfo.pageSize + index + 1 : \"\"),\n          extra: isStat ? null : /*#__PURE__*/React.createElement(\"span\", {\n            className: \"iconfont\",\n            onClick: function onClick(e) {\n              return _this2.showAlert(item.code, e);\n            },\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 60\n            }\n          }, \"\\uE676\"),\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 37\n          }\n        }), /*#__PURE__*/React.createElement(_Card.Body, {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 37\n          }\n        }, /*#__PURE__*/React.createElement(_List, {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 41\n          }\n        }, item.fields ? item.fields.map(function (it) {\n          return /*#__PURE__*/React.createElement(Item, {\n            key: it.title,\n            extra: it.value,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 49\n            }\n          }, it.title, \"\\xA0:\");\n        }) : \"\")));\n      }) : \"\", pageInfo && pageInfo.pageNo < pageInfo.virtualEndPageNo ? /*#__PURE__*/React.createElement(_Button, {\n        onClick: function onClick() {\n          return _this2.goPage(+1);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 6\n        }\n      }, \"\\u70B9\\u51FB\\u52A0\\u8F7D\\u4E0B\\u4E00\\u9875\") : /*#__PURE__*/React.createElement(\"p\", {\n        className: \"nomoredata\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 6\n        }\n      }, \"\\u6CA1\\u6709\\u66F4\\u591A\\u4E86\\xB7\\xB7\\xB7\"), /*#__PURE__*/React.createElement(_Drawer, {\n        className: showDrawer ? \"openDrawer\" : \"shutDraw\",\n        style: {\n          minHeight: document.documentElement.clientHeight - 45\n        },\n        enableDragHandle: true,\n        contentStyle: {\n          color: '#A6A6A6',\n          textAlign: 'center',\n          paddingTop: 42\n        },\n        sidebar: sidebar,\n        open: showDrawer,\n        position: \"right\",\n        touch: false,\n        onOpenChange: this.onOpenChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 17\n        }\n      }, \"\\xA0\"), /*#__PURE__*/React.createElement(_ActivityIndicator, {\n        toast: true,\n        text: \"\\u52A0\\u8F7D\\u4E2D...\",\n        animating: animating,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 17\n        }\n      }));\n    }\n  }]);\n\n  return ActTable;\n}(Component);\n\nexport { ActTable as default };","map":{"version":3,"sources":["E:/我的文件/人员定位系统/chq_position_app/src/pages/actTable/index.js"],"names":["React","Component","Nav","SearchForm","Super","Units","Storage","Item","Itempop","alert","ActTable","state","menuTitle","showDrawer","searchList","optArr","animating","menuId","props","match","params","requestList","data","isPushUrl","console","log","setState","pageNo","pageSize","history","push","super","url","method","then","res","document","removeEventListener","bodyScroll","passive","JSON","stringify","ltmpl","columns","fieldIds","criterias","forEach","item","inputType","fieldId","criteriaValueMap","k","id","toString","value","window","scrollTo","menu","title","listLtmpl","queryKey","searchFieldIds","sessionTodo","queryList","isStat","entities","fields","it","cellMap","list","pageInfo","currentPage","isSeeTotal","undefined","Loading","handlePop","onOpenChange","getSearchOptions","length","optionsMap","cardClick","code","e","preventDefault","addEventListener","goPage","no","searchwords","topageNo","handleSearch","values","showAlert","stopPropagation","alertInstance","text","onPress","handelDelete","setTimeout","close","codes","loading","status","success","info","seeTotal","count","clearTimeout","closeTimer","nextProps","decodeURI","location","search","urlToObj","menuList","actPop","sidebar","map","index","color","virtualEndPageNo","minHeight","documentElement","clientHeight","textAlign","paddingTop"],"mappings":"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","sourcesContent":["import { ActivityIndicator, Button, Card, Drawer, List, Modal, Popover, Toast, } from 'antd-mobile';\r\nimport React, { Component } from 'react';\r\nimport Nav from './../../components/Nav';\r\nimport SearchForm from './../../components/SearchForm';\r\nimport Super from './../../super';\r\nimport Units from './../../units';\r\nimport './index.less';\r\nimport Storage from './../../units/storage'\r\nconst Item = List.Item;\r\nconst Itempop = Popover.Item;\r\nconst alert = Modal.alert;\r\n\r\nexport default class ActTable extends Component {\r\n\r\n\tstate = {\r\n\t\tmenuTitle: '',\r\n\t\tshowDrawer: false,\r\n\t\tsearchList: [],\r\n\t\toptArr: {},\r\n\t\tanimating: false,\r\n\t\tmenuId:this.props.match.params.menuId\r\n\t}\r\n\tcomponentDidMount() {\r\n\t\tconst {menuId}=this.state\r\n\t\tthis.requestList(menuId)\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tclearTimeout(this.closeTimer);\r\n\t}\r\n\tcomponentWillReceiveProps(nextProps){\r\n\t\tconst {menuId} = nextProps.match.params\r\n\t\tthis.setState({menuId})\r\n\t\tconst url = decodeURI(this.props.history.location.search) //获取url参数(页码)，并解码\r\n\t\tif(url) {\r\n\t\t\tthis.requestList(menuId, Units.urlToObj(url),true)\r\n\t\t} else {\r\n            Storage[`${menuId}`]=null //刷新列表数据\r\n\t\t\tthis.requestList(menuId)\r\n\t\t}\r\n\r\n\t}\r\n\t//isPushUrl=true时，后退获得的url已有参数，不需要push链接,不然会报错\r\n\trequestList = (menuId, data, isPushUrl) => {\r\n\t\tconsole.log(\"menuId===\"+menuId);\r\n\t\tthis.setState({\r\n\t\t\tanimating: true\r\n\t\t})\r\n\t\tif(data && data.pageNo && data.pageSize && !isPushUrl) {\r\n\t\t\tthis.props.history.push(`/${menuId}?pageNo=${data.pageNo}&pageSize=${data.pageSize}`)\r\n\t\t}\r\n\t\tSuper.super({\r\n\t\t\turl: `api2/entity/${menuId}/list/tmpl`,\r\n\t\t\tmethod:'GET',\r\n\t\t\tdata:data,\r\n\t\t}).then((res) => {\r\n\t\t\tdocument.removeEventListener('touchmove', this.bodyScroll, {\r\n\t\t\t\tpassive: false\r\n\t\t\t})\r\n\t\t\tif(res) {\r\n\t\t\t\tconsole.log(\"requestList===\"+JSON.stringify(res));\r\n\t\t\t\tconsole.log(\"columns===\"+res.ltmpl.columns);\r\n\t\t\t\tconst fieldIds=[]\r\n\t\t\t\tres.ltmpl.criterias.forEach((item)=>{\r\n\t\t\t\t\tif(item.inputType===\"select\"){\r\n\t\t\t\t\t\tfieldIds.push(item.fieldId)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst criteriaValueMap=res.criteriaValueMap\r\n\t\t\t\t\tfor(let k in criteriaValueMap){\r\n\t\t\t\t\t\tif(k===item.id.toString()){\r\n\t\t\t\t\t\t\titem.value=criteriaValueMap[k]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})           \r\n\t\t\t\twindow.scrollTo(0, 0)\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tmenuTitle: res.menu.title,\r\n\t\t\t\t\tlistLtmpl: res.ltmpl.columns,\r\n\t\t\t\t\tqueryKey:res.queryKey,\r\n\t\t\t\t\tsearchList: res.ltmpl.criterias,\r\n\t\t\t\t\tshowDrawer: false,\r\n\t\t\t\t\tsearchFieldIds:fieldIds,\r\n\t\t\t\t\tanimating: false\r\n\t\t\t\t})\r\n\t\t\t\tif(Storage[`${menuId}`] && !data){\r\n\t\t\t\t\tconst res= Storage[`${menuId}`]\r\n\t\t\t\t\tthis.sessionTodo(res)\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.queryList(res.queryKey,data)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t })\r\n\t}\r\n\tqueryList=(queryKey,data)=>{\r\n        const {menuId}=this.state\r\n\t\tSuper.super({\r\n\t\t\turl:`api2/entity/list/${queryKey}/data`,\r\n\t\t\tmethod:'GET',\r\n\t\t\tdata           \r\n\t\t}).then((res)=>{\r\n\t\t\tconsole.log(\"res===\"+JSON.stringify(res));\r\n\t\t\tStorage[`${menuId}`]=res\r\n\t\t\tthis.sessionTodo(res)\r\n\t\t})          \r\n\t}\r\n\tsessionTodo=(data)=>{\r\n\t\tconsole.log(\"sessionTodo===\"+JSON.stringify(data));\r\n\t\tconst {listLtmpl}=this.state\r\n\t\tlet isStat=true\r\n        data.entities.forEach((item)=>{\r\n\t\t\titem.fields=[]\r\n\t\t\tlistLtmpl.forEach((it)=>{\r\n\t\t\t\tfor(let k in item.cellMap){\r\n\t\t\t\t\tif(it.title===\"操作\"){\r\n\t\t\t\t\t\tisStat=false\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(k===it.id.toString()){\r\n\t\t\t\t\t\tconst list={\r\n\t\t\t\t\t\t\ttitle:it.title,\r\n\t\t\t\t\t\t\tvalue:item.cellMap[k],\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\titem.fields.push(list)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n        this.setState({\r\n\t\t\tlist:data.entities,\r\n\t\t\tisStat,//判断列表是否是统计页\r\n            pageInfo:data.pageInfo,\r\n            currentPage:data.pageInfo.pageNo,   \r\n\t\t\tisSeeTotal:undefined,\r\n            Loading:false,\r\n            pageSize:data.pageInfo.pageSize,\r\n        })\r\n    }\r\n\thandlePop = (value) => {\r\n\t\tconst {menuId} = this.state\r\n\t\tif(value === \"search\") {\r\n\t\t\tthis.onOpenChange()\r\n\t\t\tthis.getSearchOptions()\r\n\t\t}else if(value === \"create\") {\r\n\t\t\tthis.props.history.push(`/create/${menuId}`)\r\n\t\t}else{\r\n\t\t\tthis.props.history.push(`/${value}`)\r\n\t\t}\r\n\t}\r\n\tgetSearchOptions = () => {\r\n\t\tconst {searchFieldIds} = this.state;\r\n\t\tif(searchFieldIds.length > 0) {\r\n\t\t\tSuper.super({\r\n\t\t\t\turl:`api2/meta/dict/field_options`,  \r\n\t\t\t\tdata:{\r\n\t\t\t\t\tfieldIds:searchFieldIds\r\n\t\t\t\t}      \r\n\t\t\t},).then((res)=>{\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\toptArr:res.optionsMap\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tcardClick = (code) => {\r\n\t\tconst {menuId} = this.state\r\n\t\tthis.props.history.push(`/${menuId}/${code}`)\r\n\t}\r\n\tbodyScroll = (e) => {\r\n\t\te.preventDefault();\r\n\t}\r\n\tonOpenChange = () => {\r\n\t\tconst {showDrawer} = this.state\r\n\t\t//console.log(showDrawer);\r\n\t\tthis.setState({\r\n\t\t\tshowDrawer: !showDrawer\r\n\t\t});\r\n\t\tif(showDrawer) { //固定页面\r\n\t\t\tdocument.removeEventListener('touchmove', this.bodyScroll, {\r\n\t\t\t\tpassive: false\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tdocument.addEventListener('touchmove', this.bodyScroll, {\r\n\t\t\t\tpassive: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tgoPage = (no) => {\r\n\t\tconst {pageInfo,menuId,searchwords} = this.state\r\n\t\tlet data = {}\r\n\t\tconst topageNo = pageInfo.pageNo + no\r\n\t\tdata.pageNo = topageNo\r\n\t\tdata.pageSize = pageInfo.pageSize\r\n\t\tfor(let k in searchwords) {\r\n\t\t\tif(searchwords[k]) {\r\n\t\t\t\tdata[k] = searchwords[k]\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.requestList(menuId, data)\r\n\t\twindow.scrollTo(0, 0)\r\n\t}\r\n\thandleSearch = (values) => {\r\n\t\tconst {menuId} = this.state\r\n\t\tthis.requestList(menuId, values)\r\n\t\tthis.setState({\r\n\t\t\tsearchwords: values\r\n\t\t})\r\n\t}\r\n\tshowAlert = (code, e) => {\r\n\t\te.stopPropagation()\r\n\t\tconst alertInstance = alert('删除操作', '确认删除这条记录吗???', [{\r\n\t\t\t\ttext: '取消'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: '确认',\r\n\t\t\t\tonPress: () => this.handelDelete(code)\r\n\t\t\t},\r\n\t\t]);\r\n\t\tsetTimeout(() => {\r\n\t\t\t// 可以调用close方法以在外部close\r\n\t\t\talertInstance.close();\r\n\t\t}, 10000);\r\n\t};\r\n\thandelDelete = (code) => {\r\n\t\tconst {menuId} = this.state\r\n\t\tSuper.super({\r\n\t\t\turl: `api2/entity/${menuId}/detail`,\r\n\t\t\tmethod:'DELETE',\r\n\t\t\tdata: {\r\n\t\t\t\tcodes: code\r\n\t\t\t}\r\n\t\t}).then((res) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tloading: false,\r\n\t\t\t\tLoading: false\r\n\t\t\t})\r\n\t\t\tif(res.status === \"suc\") {\r\n\t\t\t\tToast.success(\"删除成功！\") //刷新列表 \r\n\t\t\t\tthis.requestList(menuId,code)\r\n\t\t\t} else {\r\n\t\t\t\tToast.info('删除失败！')\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tseeTotal=()=>{\r\n        const {queryKey,isSeeTotal}=this.state\r\n        if(!isSeeTotal){\r\n            Super.super({\r\n                url:`api2/entity/list/${queryKey}/count`,\r\n\t\t\t\tmethod:'GET',\r\n            }).then((res)=>{\r\n                this.setState({\r\n                    isSeeTotal:res.count\r\n                })\r\n            })\r\n        }       \r\n    }\r\n\trender() {\r\n\t\tconst {menuTitle,list,showDrawer,searchList,optArr,pageInfo,animating,isSeeTotal,isStat} = this.state\r\n\t\tconst data =Storage.menuList\r\n\t\tlet actPop\r\n\t\tif(isStat){\r\n\t\t\tactPop = [\r\n\t\t\t\t(<Itempop key=\"5\" value=\"home\" icon={<span className=\"iconfont\">&#xe62f;</span>}>首页</Itempop>),\r\n\t\t\t\t(<Itempop key=\"1\" value=\"user\" icon={<span className=\"iconfont\">&#xe74c;</span>}>用户</Itempop>),\r\n\t\t\t\t(<Itempop key=\"3\" value=\"search\" icon={<span className=\"iconfont\">&#xe72f;</span>}>筛选</Itempop>),\r\n\t\t\t\t(<Itempop key=\"2\" value=\"login\" icon={<span className=\"iconfont\">&#xe739;</span>}>退出</Itempop>),\r\n\t\t\t]\r\n\t\t}else{\r\n\t\t\tactPop = [\r\n\t\t\t\t(<Itempop key=\"5\" value=\"home\" icon={<span className=\"iconfont\">&#xe62f;</span>}>首页</Itempop>),\r\n\t\t\t\t(<Itempop key=\"1\" value=\"user\" icon={<span className=\"iconfont\">&#xe74c;</span>}>用户</Itempop>),\r\n\t\t\t\t(<Itempop key=\"3\" value=\"search\" icon={<span className=\"iconfont\">&#xe72f;</span>}>筛选</Itempop>),\r\n\t\t\t\t(<Itempop key=\"4\" value=\"create\" icon={<span className=\"iconfont\">&#xe60a;</span>}>创建</Itempop>),\r\n\t\t\t\t(<Itempop key=\"2\" value=\"login\" icon={<span className=\"iconfont\">&#xe739;</span>}>退出</Itempop>),\r\n\t\t\t]\r\n\t\t}\r\n\t\tconst sidebar = (<SearchForm \r\n                            searchList={searchList} \r\n                            optArr={optArr} \r\n                            handleSearch={this.handleSearch}            \r\n                        />);\r\n\t\treturn(\r\n\t\t\t<div className=\"actTable\">\r\n            <Nav \r\n                title={menuTitle} \r\n                data={data}\r\n                handleSelected={this.handlePop}\r\n                pops={actPop}\r\n                />\r\n                <div className=\"topbox\">                    \r\n                    {pageInfo && pageInfo.pageNo!==1?\r\n                    <Button size=\"small\" inline onClick={()=>this.goPage(-1)}>\r\n                    上一页</Button>:\"\"}                   \r\n                    <span className=\"pageNo\">\r\n\t\t\t\t\t\t{pageInfo?`第${pageInfo.pageNo}页，`:\"\"}\r\n\t\t\t\t\t\t{isSeeTotal!==undefined?`共${isSeeTotal}条`:<span onClick={this.seeTotal}>点击查看总数</span>}\r\n                    </span>\r\n                </div>\r\n                {\r\n                    list?list.map((item,index)=>\r\n                        <Card key={item.code} onClick={isStat?()=>Toast.info(\"无详情页\"):()=>this.cardClick(item.code)}>\r\n                                    <Card.Header\r\n\t\t\t\t\t\t\t\t\t\ttitle={<span style={{color:\"#ccc\"}}>\r\n\t\t\t\t\t\t\t\t\t\t\t{pageInfo?((pageInfo.pageNo-1)*pageInfo.pageSize+index+1):\"\"}\r\n\t\t\t\t\t\t\t\t\t\t</span>}\r\n                                        extra={isStat?null:<span \r\n                                            className=\"iconfont\" \r\n                                            onClick={(e)=>this.showAlert(item.code,e)}\r\n                                            >&#xe676;</span>}\r\n                                    />\r\n                                    <Card.Body>\r\n                                        <List>\r\n                                            {item.fields?item.fields.map(it =>\r\n                                                <Item key={it.title} extra={it.value}>{it.title}&nbsp;:</Item>\r\n                                            ):\"\"}\r\n                                        </List>\r\n                                    </Card.Body>\r\n                                </Card>\r\n                    ):\"\"\r\n                }\r\n                {pageInfo && pageInfo.pageNo<pageInfo.virtualEndPageNo?\r\n\t\t\t\t\t<Button onClick={()=>this.goPage(+1)}>点击加载下一页</Button>:\r\n\t\t\t\t\t<p className=\"nomoredata\">没有更多了···</p>}\r\n                <Drawer\r\n                    className={showDrawer?\"openDrawer\":\"shutDraw\"}\r\n                    style={{ minHeight: document.documentElement.clientHeight-45 }}\r\n                    enableDragHandle\r\n                    contentStyle={{ color: '#A6A6A6', textAlign: 'center', paddingTop: 42 }}\r\n                    sidebar={sidebar}\r\n                    open={showDrawer}\r\n                    position=\"right\"\r\n                    touch={false}\r\n                    onOpenChange={this.onOpenChange}\r\n                >\r\n                &nbsp;\r\n                </Drawer>\r\n                <ActivityIndicator\r\n                    toast\r\n                    text=\"加载中...\"\r\n                    animating={animating}\r\n                />\r\n            </div>\r\n\t\t)\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}